# 学習ノート 03: デッキ作成とカード表示

## 背景
ポーカーゲームの核心である「トランプを配る」部分を実装しました。
サーバーで一元管理されたデッキからカードを引き、それをクライアントで表示する仕組みです。

## 実装のポイント

### 1. サーバー側：デッキ生成とシャッフル
Fisher-Yates アルゴリズムを用いて、偏りのないランダムなシャッフルを実装しました。

```typescript
// Fisher-Yates Shuffle
const shuffle = (deck: Card[]): Card[] => {
  for (let i = deck.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [deck[i], deck[j]] = [deck[j], deck[i]];
  }
  return deck;
};
```

### 2. コンポーネント指向での描画
将来的にカードの枚数や種類が増えることを見越し、カード 1 枚を描画するスタイルロジック `cardStyle` を分離しました。
スート（マーク）によって色を変える (`♥` `♦` は赤色) などの条件分岐も組み込んでいます。

### 3. ステートの同期
- `hand` ステート配列で受け取ったカードを管理。
- 切断時（Disconnect）に `setHand([])` で手札をリセットすることで、次の接続時に古い情報が残らないようにしています。

## 動作確認結果

### 1回目の配布
「Deal Cards」ボタンを押すと、5枚のカードが配られます。
![First Hand](/docs/learning/media/first_hand.png)

### 2回目の配布
もう一度押すと、**異なる**カードが配られる（シャッフルされている）ことが確認できます。
![Second Hand](/docs/learning/media/second_hand.png)

## 学び
- ゲームの重要データ（デッキ、シャッフル結果）は必ずサーバーで計算する（チート防止）。
- `Socket.io` のイベント駆動 (`emit` -> `on`) は、関数呼び出しのように自然に書ける。
- 配列操作 (`map`) を使えば、React で動的なリスト表示が簡単にできる。
